---

layout: post

title: 匿名且独立的网络服务：洋葱路由器

date: 2022-01-30

categories: 匿名/Anonymity

tags: Tor

description: 本文介绍一个实现匿名网络通信的自由软件。

---
<a href="https://qiu-lnt.blogspot.com/2022/01/blog-post_23.html">本文搬运自Google Blogspot上我的博客。为方便墙内网友阅读特搬运至此。博主宣</a>  
上期我们讲到怎么翻墙，期中提到一个Tor。这个Tor就是我们这期要讲的洋葱路由器。

洋葱路由器（The Onion Route），简称Tor，~~俗称“套儿”~~是实现匿名网络通信的自由软件。怎么理解这个“实现匿名网络通信”？简而言之，Tor就是一种代理软件（详情上期我们讲的“代理服务器”）相当于一种高级的网络外挂，它运用特殊的技术手段实现了相对的网络匿名。现在这个Tor由The Tor Project LLC. 提供维护和运作，其本身则是非盈利的计划，接受捐款。

如果你还是不熟悉，那我就再告诉你一点：Tor在墙内世界已经成了“暗网”（详情请看下一期）的代名词。你在百度上搜搜“暗网”，十有八九就跟Tor有关。

这个Tor是由美国的海军发明的。当时美国海军在打海湾战争，自己海军的网络通讯需要保护，免遭追踪；然后军方有一些技术人员就做出了洋葱路由器。洋葱路由器是由“中继”、“链路”和“节点” 串连起来的，其中“中继”是你连接到Tor所途径的服务器——如果用坐火车来比喻的话，中继就是火车；“节点”是你在使用Tor访问网站时经过的服务器——车站；“链路”则是你使用Tor访问网站时你和网站之间活动的途径路线——车轨。其中，链路是Tor程序自己生成的，而中继和节点来自于用户的捐赠。

这些就是Tor的一系列准则。由于你使用的并不是你公网里的host（实际IP地址），而是使用别人家的匿名host（匿名IP地址），因此你就可以通过Tor隐匿你的身份信息，实现相对的匿名，这也是Tor“洋葱”名字的来历——访问网站不是直连，而是像洋葱一样经过层层的中继和加密。截至今日，Tor是互联网上已知最为隐匿的服务。
使用Tor连接到互联网，有以下的特点：

①匿名。

比如你是CIA的特工，或者是要害机构的工作人员，为了防止秘密数据文档被截获，就要使用Tor来访问到互联网。

还有民主运动人士也需要使用Tor以防政府的攻击，比如编程随想。海外最大的政治论坛品葱也建议用户使用Tor进行访问，以防身份泄露。

②动态性。

如果你长期使用公网或者VPN来连接网络，你所有的数据都会被ISP或VPN提供商获取，这就在隐私性上-1s。

Tor“洋葱式链接”的动态性，决定了它的安全和隐私，由于你经过了多条线路，你的数据很难被ISP或VPN提供商获取。

（特别注意：接入网桥可以更为隐匿身份）

③客观性。

这完全就是站长福音好不好！！！！！

由于用的是别人家的服务器来访问网络，因此，有些时候你在你的host上建立的网站，很难看清楚别人哪块地方不能访问，这时候，只要你使用Tor，你就能知道别人看不到哪些东西，就可以修复一些既定的bug了。

④混淆性

比如你想看B站外区的视频，你就可以用Tor（明眼人都知道这个无法实现） 

⑤可以翻墙

这个不用多说了，抄一句老博文上的话：

由于Tor可以模拟被审查地区之外的IP地址，因此它也可以被用来突破网络审查。

亲测100%有效，确实，因为在被审查地区是没有Tor中继和节点的。

==================================================

下载和安装Tor

Tor提供两种服务：一种是面向广大~~受难群众~~的Tor Browser（https://www.torproject.org/download ），一种是面向~~喜欢搞一个大新闻~~的极客的Tor Expert Bundle（https://www.torproject.org/download/tor ）。

推荐大家下载Tor Browser，某些~~吃饱了没事干~~的人可以去尝试Expert Bundle。

Tor Browser是Tor为了方便大众用户使用而开发的一种特殊的Firefox浏览器。目前最新版本使用ESR版，和平常我们所用的Firefox有很大不同，敬请知悉。

（为啥用esr啊.......ESR版稳定，并且是专门开放给企业使用的，功能也少，安全）

如果你下载的是Expert Bundle，请先~~按照基本法~~下文教程，运行Tor.exe后，再配置proxy（代理）。Tor会自动在你的电脑上打开一个127.0.0.1:9050 的代理地址，其中9050是代理端口。我这种人，身经百战，见得多了，梯子的哪一个端口我没用过？

如果你下载的是Tor Browser，谢天谢地，不需要配置any proxy，你只需要打开，然后进行一些简单的设置就行了。

===============================================

请注意！

考虑到大多数人都是中国大陆人，博主在此忠告：千万不要下了就连。

这样你会收到一个《复制 Tor 日志》。

因为Tor名气太大，以至于政府都盯上它了。政府早在十年前就对Tor进行了大规模的攻击，现今如果你不配置破网代理或网桥你压根就无法使用Tor，因为Tor的连接线路会遭到政府的阻断（通常是TCP重置攻击）。

幸好Tor早有预料。它先是声明自己也支持突破网络审查；再推陈出新，发明了一种叫做“网桥”（bridge）的东西。它主要通过混淆流量的方式突破网络审查或隐匿身份。

比较知名的网桥主要有obfs4（现在本人在用obfs4+socks5）、meek-azure（俗称“水管”，唯一在中国大陆接得通的）和Snowflake。

以meek-azure为例， 它的原理是将Tor的网络流量伪装成访问Microsoft Azure云服务的流量，使得审查机构无法阻止用户访问Tor。（实际上所有meek网桥都是这么干的，以前有过meek-google，结果谷歌到14年被屏蔽它就歇菜了，网桥好不好还得看东家心情）

所以，博主在此再次忠告：请挂meek！

不过博主也不推荐meek，因为meek就是个水管，连进去了也是憨批网速。所以，建议大家还是获取网桥。

获取网桥靠的是Tor Project的邮件服务器，因为防火长城无法对邮件内容进行审查，所以你是可以通过邮件获取网桥的。输入验证码，你会得到一段网桥，但是失效很快，有的根本就没有效果。

因此，博主推荐的是代理+网桥。挂代理上Tor并不困难，Tor Browser基于Firefox自带代理服务器配置功能，你只需要将代理设置为“SOCKS 5”，然后填写你的代理地址和端口。

Tor Expert Bundle则需要用户在torrc文件中自行配置下面的代码：

 Socks5Proxy 127.0.0.1:9909（使用例，127.0.0.1可以替换为你的代理IP地址，9909可以替换为代理端口）

注意：全局代理也对Tor有效，因此建议大家开全局。

挂代理之后~~一突开啊溅得我满脸喷粪啊，满脸是粪~~可以做到5秒就连接，但是为了更好隐匿身份，还是要挂obfs4或者snowflake网桥。

连接上之后可以使用Tor访问一般的网站（本人最多去的是品韭、2047、reddit和matters），也可以访问隐藏服务（Hidden Services）

隐藏服务是Tor的附加功能，其用意是为了让服务器端也做到匿名。典型的隐藏服务域名以两部分组成，前面一段是系统自动生成的字符串key，后面一段是域名代码 .onion（代表洋葱）。

生成隐藏服务并不困难，你只需要在自己家的电脑（或服务器）上配置好LAMP或WAMP环境，然后在torrc文件中加入这么一行代码就成：

HiddenServiceDir 选择你存放域名的路径
HiddenServicePort 80 127.0.0.1:端口

隐藏服务可以是www，也可以是TCP（访问有点难度）。

隐藏服务非常有名，因为它还有一个大名鼎鼎的称号——暗网网站（Darkweb Site）。

Tor上有50%-60%不等的违法网站（政治敏感除外），这些网站大多是关于违禁品贩卖、人口贩卖和色情业的，为了逃避审查常使用Tor的隐藏服务，因此这些网站多是隐藏服务域名。

（另外教给大家一个绝招：New Identity，你可以通过这个功能一键放弃现在的身份，说明你的标识码出现了变动，所有网站注销）

==============================================

最后吐槽一下Tor Browser的三条大白边（隐藏浏览器指纹）呵呵呵呵
